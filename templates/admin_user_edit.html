{% extends "base.html" %}

{% block title %}Admin: ユーザー編集 - HoroloGen{% endblock %}

{% block content %}
<h1>Admin: ユーザー編集</h1>

{% if reset_password_notice %}
<div style="margin: 12px 0; background: #fff8db; border: 1px solid #efd38a; padding: 12px; border-radius: 6px;">
    <p><strong>再発行対象:</strong> {{ reset_password_notice.email }}</p>
    <p><strong>仮パスワード（この1回のみ表示）:</strong> <code>{{ reset_password_notice.temporary_password }}</code></p>
</div>
{% endif %}

<div class="form-group">
    <label>Email</label>
    <input type="text" value="{{ user.email }}" readonly>
</div>
<div class="form-group">
    <label>Role</label>
    <input type="text" value="{{ user.role }}" readonly>
</div>
<div class="form-group">
    <label>Tenant</label>
    <input type="text" value="{% if user.tenant_id %}{{ tenant_name }} (id={{ user.tenant_id }}){% else %}-{% endif %}" readonly>
</div>
<div class="form-group">
    <label>Active</label>
    <input type="text" value="{{ 'true' if user.is_active else 'false' }}" readonly>
</div>

<p style="margin: 16px 0;">
    {% if user.is_active %}
    <form method="POST" action="{{ url_for('admin_user_deactivate', user_id=user.id) }}" style="display:inline;">
        <input type="hidden" name="next" value="{{ next_path }}">
        <button type="submit">Deactivate</button>
    </form>
    {% else %}
    <form method="POST" action="{{ url_for('admin_user_activate', user_id=user.id) }}" style="display:inline;">
        <input type="hidden" name="next" value="{{ next_path }}">
        <button type="submit">Activate</button>
    </form>
    {% endif %}
    |
    {% if user.is_active %}
    <form method="POST" action="{{ url_for('admin_reset_password', user_id=user.id) }}" style="display:inline;">
        <input type="hidden" name="next" value="{{ next_path }}">
        <button type="submit">仮パス再発行</button>
    </form>
    {% endif %}
</p>

<p>
    <a href="{{ next_path }}">一覧へ戻る</a>
</p>
{% endblock %}
